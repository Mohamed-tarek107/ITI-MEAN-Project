<!-- Search Form -->
<form class="d-flex ms-4 pb-4 pt-3"
    role="search"
    (submit)="onSearch($event)">
<input class="form-control me-2 rounded-pill border-0 shadow-sm"
        type="search"
        [(ngModel)]="search"
        name="search"
        placeholder="Search and explore..."
        aria-label="Search"
        style="padding-left: 20px;" />
<button class="btn btn-warning rounded-pill shadow-sm fw-bold px-4" type="submit">Search</button>
</form>

@if (search && search.trim() && results.length > 0) {
<div class="ms-4 mb-3">
    <h4 class="text-dark">Search Results for: <span class="text-warning">{{ search }}</span></h4>
</div>
}

<div class="movies-container"
    style="display:flex; flex-wrap:wrap; gap:1rem; justify-content:center; margin-top:1rem;">

@for (movie of results; track movie.id) {
    <div
    class="card"
    *ngFor="let movie of results"
    style="
      width: 13rem;
      height: 24rem;
      overflow: hidden;
      position: relative;
      border: none;
      border-radius: 10px;
    "
  >
    <a [routerLink]="['/details', movie.id]">
      <img
        [src]="'https://image.tmdb.org/t/p/w500' + movie.poster"
        class="card-img-top"
        alt="{{ movie.title }}"
        style="object-fit: cover; width: 100%; height: 100%; border-radius: 10px"
      />
    </a>

    <i
      class="bi bi-circle-fill"
      style="
        color: rgba(234, 231, 231, 0.571);
        position: absolute;
        top: 8px;
        right: 8px;
        cursor: pointer;
      "
    ></i>
    <i
      class="bi bi-three-dots"
      style="position: absolute; top: 8px; right: 8px; cursor: pointer"
    ></i>

    <div
      style="
        position: absolute;
        top: calc(45% + 70px);
        left: calc(50% - 95px);
        width: 40px;
        height: 40px;
        background-color: black;
        border: 2px solid green;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
        color: white;
        font-weight: bold;
        font-size: 16px;
      "
    >
      {{ movie.vote_average | number : '1.1-1' }}
    </div>

    <div class="card-body" style="height: 40%; overflow: hidden">
      <h5 class="card-title fs-6 fw-semibold pt-1">{{ movie.title }}</h5>
      <div style="display: flex; align-items: center">
        <p class="card-text mb-0">{{ movie.release_date | date : 'MMM d, y' }}</p>
        <button class="btn ms-auto" (click)="toggleLike(movie)">
          <i
            class="fa-solid fa-heart heart-icon"
            [ngClass]="{ liked: movie.isLiked, animate: movie.animateLike }"
            (click)="toggleLike(movie)"
            style="position: absolute; top: 8px; right: 8px; cursor: pointer; font-size: 1.5rem"
          >
          </i>
        </button>
      </div>
    </div>
  </div>
}
</div>